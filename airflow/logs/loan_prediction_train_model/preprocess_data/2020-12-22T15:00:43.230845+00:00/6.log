[2020-12-22 15:09:26,113] {taskinstance.py:655} INFO - Dependencies all met for <TaskInstance: loan_prediction_train_model.preprocess_data 2020-12-22T15:00:43.230845+00:00 [queued]>
[2020-12-22 15:09:26,128] {taskinstance.py:655} INFO - Dependencies all met for <TaskInstance: loan_prediction_train_model.preprocess_data 2020-12-22T15:00:43.230845+00:00 [queued]>
[2020-12-22 15:09:26,129] {taskinstance.py:866} INFO - 
--------------------------------------------------------------------------------
[2020-12-22 15:09:26,129] {taskinstance.py:867} INFO - Starting attempt 6 of 6
[2020-12-22 15:09:26,129] {taskinstance.py:868} INFO - 
--------------------------------------------------------------------------------
[2020-12-22 15:09:26,140] {taskinstance.py:887} INFO - Executing <Task(LivyBatchOperator): preprocess_data> on 2020-12-22T15:00:43.230845+00:00
[2020-12-22 15:09:26,144] {standard_task_runner.py:53} INFO - Started process 11733 to run task
[2020-12-22 15:09:26,202] {logging_mixin.py:112} INFO - Running %s on host %s <TaskInstance: loan_prediction_train_model.preprocess_data 2020-12-22T15:00:43.230845+00:00 [running]> 6e29624e1b8e
[2020-12-22 15:09:26,227] {logging_mixin.py:112} INFO - [2020-12-22 15:09:26,226] {batch.py:214} INFO - Submitting the batch to Livy... Payload:
{
  "file": "s3a://alanchn31-loan-default-prediction/dist/main.py",
  "args": [
    "--job",
    "preprocess_data",
    "--phase",
    "train",
    "--mode",
    "aws",
    "--awsKey",
    "AKIAUW4FKHTMR2UR3INH",
    "--awsSecretKey",
    "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",
    "--s3Bucket",
    "alanchn31-loan-default-prediction"
  ],
  "pyFiles": [
    "s3a://alanchn31-loan-default-prediction/dist/src.zip"
  ],
  "files": [
    "s3a://alanchn31-loan-default-prediction/dist/config.json"
  ],
  "name": "preprocess_data_scheduled__2020-12-22T15:00:43.230845+00:00"
}
[2020-12-22 15:09:26,236] {logging_mixin.py:112} INFO - [2020-12-22 15:09:26,235] {base_hook.py:84} INFO - Using connection to: id: livy. Host: ec2-3-236-26-7.compute-1.amazonaws.com, Port: 8998, Schema: None, Login: None, Password: None, extra: None
[2020-12-22 15:09:26,239] {logging_mixin.py:112} INFO - [2020-12-22 15:09:26,238] {http_hook.py:136} INFO - Sending 'POST' to url: http://ec2-3-236-26-7.compute-1.amazonaws.com:8998/batches
[2020-12-22 15:09:26,262] {logging_mixin.py:112} INFO - [2020-12-22 15:09:26,262] {batch.py:166} INFO - Batch successfully submitted with id = 10.
[2020-12-22 15:09:26,263] {logging_mixin.py:112} INFO - [2020-12-22 15:09:26,263] {batch.py:80} INFO - Getting batch 10 status...
[2020-12-22 15:09:26,270] {logging_mixin.py:112} INFO - [2020-12-22 15:09:26,270] {base_hook.py:84} INFO - Using connection to: id: livy. Host: ec2-3-236-26-7.compute-1.amazonaws.com, Port: 8998, Schema: None, Login: None, Password: None, extra: None
[2020-12-22 15:09:26,273] {logging_mixin.py:112} INFO - [2020-12-22 15:09:26,273] {http_hook.py:136} INFO - Sending 'GET' to url: http://ec2-3-236-26-7.compute-1.amazonaws.com:8998/batches/10
[2020-12-22 15:09:26,280] {logging_mixin.py:112} INFO - [2020-12-22 15:09:26,279] {batch.py:90} INFO - Batch 10 has not finished yet (state is 'starting')
[2020-12-22 15:09:46,298] {logging_mixin.py:112} INFO - [2020-12-22 15:09:46,298] {batch.py:80} INFO - Getting batch 10 status...
[2020-12-22 15:09:46,322] {logging_mixin.py:112} INFO - [2020-12-22 15:09:46,322] {base_hook.py:84} INFO - Using connection to: id: livy. Host: ec2-3-236-26-7.compute-1.amazonaws.com, Port: 8998, Schema: None, Login: None, Password: None, extra: None
[2020-12-22 15:09:46,326] {logging_mixin.py:112} INFO - [2020-12-22 15:09:46,326] {http_hook.py:136} INFO - Sending 'GET' to url: http://ec2-3-236-26-7.compute-1.amazonaws.com:8998/batches/10
[2020-12-22 15:09:46,344] {logging_mixin.py:112} INFO - [2020-12-22 15:09:46,343] {batch.py:90} INFO - Batch 10 has not finished yet (state is 'running')
[2020-12-22 15:10:06,372] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,371] {batch.py:80} INFO - Getting batch 10 status...
[2020-12-22 15:10:06,379] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,379] {base_hook.py:84} INFO - Using connection to: id: livy. Host: ec2-3-236-26-7.compute-1.amazonaws.com, Port: 8998, Schema: None, Login: None, Password: None, extra: None
[2020-12-22 15:10:06,380] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,380] {http_hook.py:136} INFO - Sending 'GET' to url: http://ec2-3-236-26-7.compute-1.amazonaws.com:8998/batches/10
[2020-12-22 15:10:06,395] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,395] {batch.py:299} INFO - --------------------------------------------------Full log for batch 10--------------------------------------------------
[2020-12-22 15:10:06,402] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,402] {base_hook.py:84} INFO - Using connection to: id: livy. Host: ec2-3-236-26-7.compute-1.amazonaws.com, Port: 8998, Schema: None, Login: None, Password: None, extra: None
[2020-12-22 15:10:06,403] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,403] {http_hook.py:136} INFO - Sending 'GET' to url: http://ec2-3-236-26-7.compute-1.amazonaws.com:8998/batches/10/log?from=0&size=100
[2020-12-22 15:10:06,417] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,417] {batch.py:309} INFO - stdout: 
[2020-12-22 15:10:06,418] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,417] {batch.py:309} INFO - 2020-12-22 15:09:33,955 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/jcl-over-slf4j-1.7.16.jar
[2020-12-22 15:10:06,418] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,418] {batch.py:309} INFO - 2020-12-22 15:09:33,957 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/jersey-client-2.22.2.jar
[2020-12-22 15:10:06,418] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,418] {batch.py:309} INFO - 2020-12-22 15:09:33,958 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/jersey-common-2.22.2.jar
[2020-12-22 15:10:06,418] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,418] {batch.py:309} INFO - 2020-12-22 15:09:33,966 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/jersey-container-servlet-2.22.2.jar
[2020-12-22 15:10:06,419] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,418] {batch.py:309} INFO - 2020-12-22 15:09:33,967 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/jersey-container-servlet-core-2.22.2.jar
[2020-12-22 15:10:06,419] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,419] {batch.py:309} INFO - 2020-12-22 15:09:33,968 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/jersey-guava-2.22.2.jar
[2020-12-22 15:10:06,419] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,419] {batch.py:309} INFO - 2020-12-22 15:09:33,970 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/jersey-media-jaxb-2.22.2.jar
[2020-12-22 15:10:06,419] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,419] {batch.py:309} INFO - 2020-12-22 15:09:33,971 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/jersey-server-2.22.2.jar
[2020-12-22 15:10:06,419] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,419] {batch.py:309} INFO - 2020-12-22 15:09:33,973 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/joda-time-2.9.3.jar
[2020-12-22 15:10:06,420] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,420] {batch.py:309} INFO - 2020-12-22 15:09:33,974 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/json4s-ast_2.11-3.5.3.jar
[2020-12-22 15:10:06,420] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,420] {batch.py:309} INFO - 2020-12-22 15:09:33,976 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/json4s-core_2.11-3.5.3.jar
[2020-12-22 15:10:06,420] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,420] {batch.py:309} INFO - 2020-12-22 15:09:33,978 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/json4s-jackson_2.11-3.5.3.jar
[2020-12-22 15:10:06,420] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,420] {batch.py:309} INFO - 2020-12-22 15:09:33,979 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/json4s-scalap_2.11-3.5.3.jar
[2020-12-22 15:10:06,421] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,420] {batch.py:309} INFO - 2020-12-22 15:09:33,980 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/jsr305-1.3.9.jar
[2020-12-22 15:10:06,421] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,421] {batch.py:309} INFO - 2020-12-22 15:09:33,981 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/jtransforms-2.4.0.jar
[2020-12-22 15:10:06,421] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,421] {batch.py:309} INFO - 2020-12-22 15:09:33,983 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/jul-to-slf4j-1.7.16.jar
[2020-12-22 15:10:06,421] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,421] {batch.py:309} INFO - 2020-12-22 15:09:33,984 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/kryo-shaded-4.0.2.jar
[2020-12-22 15:10:06,421] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,421] {batch.py:309} INFO - 2020-12-22 15:09:33,986 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/kubernetes-client-4.6.1.jar
[2020-12-22 15:10:06,422] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,422] {batch.py:309} INFO - 2020-12-22 15:09:33,987 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/kubernetes-model-4.6.1.jar
[2020-12-22 15:10:06,422] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,422] {batch.py:309} INFO - 2020-12-22 15:09:33,988 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/kubernetes-model-common-4.6.1.jar
[2020-12-22 15:10:06,422] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,422] {batch.py:309} INFO - 2020-12-22 15:09:33,990 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/leveldbjni-all-1.8.jar
[2020-12-22 15:10:06,422] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,422] {batch.py:309} INFO - 2020-12-22 15:09:33,991 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/logging-interceptor-3.12.0.jar
[2020-12-22 15:10:06,422] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,422] {batch.py:309} INFO - 2020-12-22 15:09:33,992 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/lz4-java-1.4.0.jar
[2020-12-22 15:10:06,423] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,423] {batch.py:309} INFO - 2020-12-22 15:09:33,994 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/machinist_2.11-0.6.1.jar
[2020-12-22 15:10:06,423] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,423] {batch.py:309} INFO - 2020-12-22 15:09:33,995 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/macro-compat_2.11-1.1.1.jar
[2020-12-22 15:10:06,423] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,423] {batch.py:309} INFO - 2020-12-22 15:09:33,996 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/mesos-1.4.0-shaded-protobuf.jar
[2020-12-22 15:10:06,423] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,423] {batch.py:309} INFO - 2020-12-22 15:09:33,997 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/metrics-core-3.1.5.jar
[2020-12-22 15:10:06,424] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,424] {batch.py:309} INFO - 2020-12-22 15:09:33,999 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/metrics-graphite-3.1.5.jar
[2020-12-22 15:10:06,424] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,424] {batch.py:309} INFO - 2020-12-22 15:09:34,000 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/metrics-json-3.1.5.jar
[2020-12-22 15:10:06,425] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,424] {batch.py:309} INFO - 2020-12-22 15:09:34,001 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/metrics-jvm-3.1.5.jar
[2020-12-22 15:10:06,425] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,425] {batch.py:309} INFO - 2020-12-22 15:09:34,003 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/minlog-1.3.0.jar
[2020-12-22 15:10:06,425] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,425] {batch.py:309} INFO - 2020-12-22 15:09:34,004 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/netty-3.9.9.Final.jar
[2020-12-22 15:10:06,425] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,425] {batch.py:309} INFO - 2020-12-22 15:09:34,005 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/netty-all-4.1.42.Final.jar
[2020-12-22 15:10:06,425] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,425] {batch.py:309} INFO - 2020-12-22 15:09:34,006 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/objenesis-2.5.1.jar
[2020-12-22 15:10:06,425] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,425] {batch.py:309} INFO - 2020-12-22 15:09:34,007 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/okhttp-3.12.0.jar
[2020-12-22 15:10:06,426] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,426] {batch.py:309} INFO - 2020-12-22 15:09:34,009 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/okio-1.15.0.jar
[2020-12-22 15:10:06,426] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,426] {batch.py:309} INFO - 2020-12-22 15:09:34,010 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/opencsv-2.3.jar
[2020-12-22 15:10:06,426] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,426] {batch.py:309} INFO - 2020-12-22 15:09:34,011 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/orc-core-1.5.5-nohive.jar
[2020-12-22 15:10:06,426] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,426] {batch.py:309} INFO - 2020-12-22 15:09:34,012 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/orc-mapreduce-1.5.5-nohive.jar
[2020-12-22 15:10:06,426] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,426] {batch.py:309} INFO - 2020-12-22 15:09:34,014 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/orc-shims-1.5.5.jar
[2020-12-22 15:10:06,426] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,426] {batch.py:309} INFO - 2020-12-22 15:09:34,015 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/oro-2.0.8.jar
[2020-12-22 15:10:06,427] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,427] {batch.py:309} INFO - 2020-12-22 15:09:34,016 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/osgi-resource-locator-1.0.1.jar
[2020-12-22 15:10:06,427] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,427] {batch.py:309} INFO - 2020-12-22 15:09:34,017 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/paranamer-2.8.jar
[2020-12-22 15:10:06,427] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,427] {batch.py:309} INFO - 2020-12-22 15:09:34,019 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/parquet-column-1.10.1.jar
[2020-12-22 15:10:06,428] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,427] {batch.py:309} INFO - 2020-12-22 15:09:34,020 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/parquet-common-1.10.1.jar
[2020-12-22 15:10:06,428] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,428] {batch.py:309} INFO - 2020-12-22 15:09:34,021 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/parquet-encoding-1.10.1.jar
[2020-12-22 15:10:06,428] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,428] {batch.py:309} INFO - 2020-12-22 15:09:34,022 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/parquet-format-2.4.0.jar
[2020-12-22 15:10:06,428] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,428] {batch.py:309} INFO - 2020-12-22 15:09:34,023 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/parquet-hadoop-1.10.1.jar
[2020-12-22 15:10:06,428] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,428] {batch.py:309} INFO - 2020-12-22 15:09:34,025 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/parquet-jackson-1.10.1.jar
[2020-12-22 15:10:06,429] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,428] {batch.py:309} INFO - 2020-12-22 15:09:34,026 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/py4j-0.10.7.jar
[2020-12-22 15:10:06,429] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,429] {batch.py:309} INFO - 2020-12-22 15:09:34,027 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/pyrolite-4.13.jar
[2020-12-22 15:10:06,429] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,429] {batch.py:309} INFO - 2020-12-22 15:09:34,028 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/scala-compiler-2.11.12.jar
[2020-12-22 15:10:06,429] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,429] {batch.py:309} INFO - 2020-12-22 15:09:34,030 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/scala-library-2.11.12.jar
[2020-12-22 15:10:06,429] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,429] {batch.py:309} INFO - 2020-12-22 15:09:34,031 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/scala-parser-combinators_2.11-1.1.0.jar
[2020-12-22 15:10:06,430] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,429] {batch.py:309} INFO - 2020-12-22 15:09:34,032 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/scala-reflect-2.11.12.jar
[2020-12-22 15:10:06,430] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,430] {batch.py:309} INFO - 2020-12-22 15:09:34,034 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/scala-xml_2.11-1.0.5.jar
[2020-12-22 15:10:06,430] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,430] {batch.py:309} INFO - 2020-12-22 15:09:34,035 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/shapeless_2.11-2.3.2.jar
[2020-12-22 15:10:06,430] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,430] {batch.py:309} INFO - 2020-12-22 15:09:34,037 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/shims-0.7.45.jar
[2020-12-22 15:10:06,430] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,430] {batch.py:309} INFO - 2020-12-22 15:09:34,038 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/snakeyaml-1.15.jar
[2020-12-22 15:10:06,431] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,431] {batch.py:309} INFO - 2020-12-22 15:09:34,039 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/snappy-java-1.1.7.3.jar
[2020-12-22 15:10:06,431] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,431] {batch.py:309} INFO - 2020-12-22 15:09:34,041 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-catalyst_2.11-2.4.5.jar
[2020-12-22 15:10:06,431] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,431] {batch.py:309} INFO - 2020-12-22 15:09:34,043 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-core_2.11-2.4.5.jar
[2020-12-22 15:10:06,431] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,431] {batch.py:309} INFO - 2020-12-22 15:09:34,044 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-graphx_2.11-2.4.5.jar
[2020-12-22 15:10:06,432] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,431] {batch.py:309} INFO - 2020-12-22 15:09:34,046 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-hive_2.11-2.4.5.jar
[2020-12-22 15:10:06,432] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,432] {batch.py:309} INFO - 2020-12-22 15:09:34,047 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-kubernetes_2.11-2.4.5.jar
[2020-12-22 15:10:06,432] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,432] {batch.py:309} INFO - 2020-12-22 15:09:34,048 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-kvstore_2.11-2.4.5.jar
[2020-12-22 15:10:06,432] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,432] {batch.py:309} INFO - 2020-12-22 15:09:34,050 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-launcher_2.11-2.4.5.jar
[2020-12-22 15:10:06,432] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,432] {batch.py:309} INFO - 2020-12-22 15:09:34,052 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-mesos_2.11-2.4.5.jar
[2020-12-22 15:10:06,433] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,432] {batch.py:309} INFO - 2020-12-22 15:09:34,053 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-mllib-local_2.11-2.4.5.jar
[2020-12-22 15:10:06,433] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,433] {batch.py:309} INFO - 2020-12-22 15:09:34,054 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-mllib_2.11-2.4.5.jar
[2020-12-22 15:10:06,433] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,433] {batch.py:309} INFO - 2020-12-22 15:09:34,056 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-network-common_2.11-2.4.5.jar
[2020-12-22 15:10:06,433] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,433] {batch.py:309} INFO - 2020-12-22 15:09:34,057 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-network-shuffle_2.11-2.4.5.jar
[2020-12-22 15:10:06,433] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,433] {batch.py:309} INFO - 2020-12-22 15:09:34,058 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-repl_2.11-2.4.5.jar
[2020-12-22 15:10:06,434] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,433] {batch.py:309} INFO - 2020-12-22 15:09:34,060 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-sketch_2.11-2.4.5.jar
[2020-12-22 15:10:06,434] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,434] {batch.py:309} INFO - 2020-12-22 15:09:34,062 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-sql_2.11-2.4.5.jar
[2020-12-22 15:10:06,434] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,434] {batch.py:309} INFO - 2020-12-22 15:09:34,063 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-streaming_2.11-2.4.5.jar
[2020-12-22 15:10:06,434] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,434] {batch.py:309} INFO - 2020-12-22 15:09:34,064 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-tags_2.11-2.4.5-tests.jar
[2020-12-22 15:10:06,434] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,434] {batch.py:309} INFO - 2020-12-22 15:09:34,068 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-tags_2.11-2.4.5.jar
[2020-12-22 15:10:06,435] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,435] {batch.py:309} INFO - 2020-12-22 15:09:34,070 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-unsafe_2.11-2.4.5.jar
[2020-12-22 15:10:06,435] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,435] {batch.py:309} INFO - 2020-12-22 15:09:34,071 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spark-yarn_2.11-2.4.5.jar
[2020-12-22 15:10:06,435] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,435] {batch.py:309} INFO - 2020-12-22 15:09:34,072 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spire-macros_2.11-0.13.0.jar
[2020-12-22 15:10:06,435] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,435] {batch.py:309} INFO - 2020-12-22 15:09:34,074 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/spire_2.11-0.13.0.jar
[2020-12-22 15:10:06,435] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,435] {batch.py:309} INFO - 2020-12-22 15:09:34,075 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/stream-2.7.0.jar
[2020-12-22 15:10:06,436] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,436] {batch.py:309} INFO - 2020-12-22 15:09:34,076 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/univocity-parsers-2.7.3.jar
[2020-12-22 15:10:06,436] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,436] {batch.py:309} INFO - 2020-12-22 15:09:34,077 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/validation-api-1.1.0.Final.jar
[2020-12-22 15:10:06,436] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,436] {batch.py:309} INFO - 2020-12-22 15:09:34,082 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/xbean-asm6-shaded-4.8.jar
[2020-12-22 15:10:06,436] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,436] {batch.py:309} INFO - 2020-12-22 15:09:34,083 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/xz-1.5.jar
[2020-12-22 15:10:06,436] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,436] {batch.py:309} INFO - 2020-12-22 15:09:34,084 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/zjsonpatch-0.3.0.jar
[2020-12-22 15:10:06,436] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,436] {batch.py:309} INFO - 2020-12-22 15:09:34,088 INFO yarn.Client: Source and destination file systems are the same. Not copying hdfs://master:9000/spark-jars/zstd-jni-1.3.2-2.jar
[2020-12-22 15:10:06,437] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,437] {batch.py:309} INFO - 2020-12-22 15:09:34,094 INFO yarn.Client: Uploading resource s3a://alanchn31-loan-default-prediction/dist/config.json -> hdfs://master:9000/user/root/.sparkStaging/application_1608647635904_0011/config.json
[2020-12-22 15:10:06,437] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,437] {batch.py:309} INFO - 2020-12-22 15:09:34,320 INFO yarn.Client: Uploading resource file:/usr/spark/python/lib/pyspark.zip -> hdfs://master:9000/user/root/.sparkStaging/application_1608647635904_0011/pyspark.zip
[2020-12-22 15:10:06,437] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,437] {batch.py:309} INFO - 2020-12-22 15:09:34,395 INFO yarn.Client: Uploading resource file:/usr/spark/python/lib/py4j-0.10.7-src.zip -> hdfs://master:9000/user/root/.sparkStaging/application_1608647635904_0011/py4j-0.10.7-src.zip
[2020-12-22 15:10:06,437] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,437] {batch.py:309} INFO - 2020-12-22 15:09:34,422 INFO yarn.Client: Uploading resource s3a://alanchn31-loan-default-prediction/dist/src.zip -> hdfs://master:9000/user/root/.sparkStaging/application_1608647635904_0011/src.zip
[2020-12-22 15:10:06,437] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,437] {batch.py:309} INFO - 2020-12-22 15:09:34,894 INFO yarn.Client: Uploading resource file:/tmp/spark-224f6a6b-33c4-4a7e-93b5-7b31e071671c/__spark_conf__2202812121199024189.zip -> hdfs://master:9000/user/root/.sparkStaging/application_1608647635904_0011/__spark_conf__.zip
[2020-12-22 15:10:06,438] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,437] {batch.py:309} INFO - 2020-12-22 15:09:34,944 INFO spark.SecurityManager: Changing view acls to: root
[2020-12-22 15:10:06,438] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,438] {batch.py:309} INFO - 2020-12-22 15:09:34,945 INFO spark.SecurityManager: Changing modify acls to: root
[2020-12-22 15:10:06,438] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,438] {batch.py:309} INFO - 2020-12-22 15:09:34,946 INFO spark.SecurityManager: Changing view acls groups to: 
[2020-12-22 15:10:06,438] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,438] {batch.py:309} INFO - 2020-12-22 15:09:34,947 INFO spark.SecurityManager: Changing modify acls groups to: 
[2020-12-22 15:10:06,438] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,438] {batch.py:309} INFO - 2020-12-22 15:09:34,947 INFO spark.SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(root); groups with view permissions: Set(); users  with modify permissions: Set(root); groups with modify permissions: Set()
[2020-12-22 15:10:06,445] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,445] {base_hook.py:84} INFO - Using connection to: id: livy. Host: ec2-3-236-26-7.compute-1.amazonaws.com, Port: 8998, Schema: None, Login: None, Password: None, extra: None
[2020-12-22 15:10:06,446] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,445] {http_hook.py:136} INFO - Sending 'GET' to url: http://ec2-3-236-26-7.compute-1.amazonaws.com:8998/batches/10/log?from=100&size=100
[2020-12-22 15:10:06,466] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,466] {batch.py:309} INFO - 2020-12-22 15:09:36,348 INFO yarn.Client: Submitting application application_1608647635904_0011 to ResourceManager
[2020-12-22 15:10:06,467] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,467] {batch.py:309} INFO - 2020-12-22 15:09:36,414 INFO impl.YarnClientImpl: Submitted application application_1608647635904_0011
[2020-12-22 15:10:06,467] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,467] {batch.py:309} INFO - 2020-12-22 15:09:36,416 INFO cluster.SchedulerExtensionServices: Starting Yarn extension services with app application_1608647635904_0011 and attemptId None
[2020-12-22 15:10:06,467] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,467] {batch.py:309} INFO - 2020-12-22 15:09:37,424 INFO yarn.Client: Application report for application_1608647635904_0011 (state: ACCEPTED)
[2020-12-22 15:10:06,468] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,467] {batch.py:309} INFO - 2020-12-22 15:09:37,429 INFO yarn.Client: 
[2020-12-22 15:10:06,469] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,468] {batch.py:309} INFO - 	 client token: N/A
[2020-12-22 15:10:06,469] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,469] {batch.py:309} INFO - 	 diagnostics: AM container is launched, waiting for AM container to Register with RM
[2020-12-22 15:10:06,469] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,469] {batch.py:309} INFO - 	 ApplicationMaster host: N/A
[2020-12-22 15:10:06,469] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,469] {batch.py:309} INFO - 	 ApplicationMaster RPC port: -1
[2020-12-22 15:10:06,469] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,469] {batch.py:309} INFO - 	 queue: root.root
[2020-12-22 15:10:06,469] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,469] {batch.py:309} INFO - 	 start time: 1608649776370
[2020-12-22 15:10:06,469] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,469] {batch.py:309} INFO - 	 final status: UNDEFINED
[2020-12-22 15:10:06,470] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,470] {batch.py:309} INFO - 	 tracking URL: http://master:8088/proxy/application_1608647635904_0011/
[2020-12-22 15:10:06,471] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,471] {batch.py:309} INFO - 	 user: root
[2020-12-22 15:10:06,471] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,471] {batch.py:309} INFO - 2020-12-22 15:09:38,437 INFO yarn.Client: Application report for application_1608647635904_0011 (state: ACCEPTED)
[2020-12-22 15:10:06,471] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,471] {batch.py:309} INFO - 2020-12-22 15:09:39,451 INFO yarn.Client: Application report for application_1608647635904_0011 (state: ACCEPTED)
[2020-12-22 15:10:06,472] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,471] {batch.py:309} INFO - 2020-12-22 15:09:40,467 INFO yarn.Client: Application report for application_1608647635904_0011 (state: ACCEPTED)
[2020-12-22 15:10:06,472] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,472] {batch.py:309} INFO - 2020-12-22 15:09:41,469 INFO yarn.Client: Application report for application_1608647635904_0011 (state: ACCEPTED)
[2020-12-22 15:10:06,472] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,472] {batch.py:309} INFO - 2020-12-22 15:09:42,475 INFO yarn.Client: Application report for application_1608647635904_0011 (state: RUNNING)
[2020-12-22 15:10:06,472] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,472] {batch.py:309} INFO - 2020-12-22 15:09:42,475 INFO yarn.Client: 
[2020-12-22 15:10:06,472] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,472] {batch.py:309} INFO - 	 client token: N/A
[2020-12-22 15:10:06,472] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,472] {batch.py:309} INFO - 	 diagnostics: N/A
[2020-12-22 15:10:06,473] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,473] {batch.py:309} INFO - 	 ApplicationMaster host: 172.18.0.8
[2020-12-22 15:10:06,473] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,473] {batch.py:309} INFO - 	 ApplicationMaster RPC port: -1
[2020-12-22 15:10:06,473] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,473] {batch.py:309} INFO - 	 queue: root.root
[2020-12-22 15:10:06,473] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,473] {batch.py:309} INFO - 	 start time: 1608649776370
[2020-12-22 15:10:06,473] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,473] {batch.py:309} INFO - 	 final status: UNDEFINED
[2020-12-22 15:10:06,474] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,474] {batch.py:309} INFO - 	 tracking URL: http://master:8088/proxy/application_1608647635904_0011/
[2020-12-22 15:10:06,474] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,474] {batch.py:309} INFO - 	 user: root
[2020-12-22 15:10:06,474] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,474] {batch.py:309} INFO - 2020-12-22 15:09:42,477 INFO cluster.YarnClientSchedulerBackend: Application application_1608647635904_0011 has started running.
[2020-12-22 15:10:06,474] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,474] {batch.py:309} INFO - 2020-12-22 15:09:42,491 INFO util.Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 7002.
[2020-12-22 15:10:06,474] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,474] {batch.py:309} INFO - 2020-12-22 15:09:42,492 INFO netty.NettyBlockTransferService: Server created on livy:7002
[2020-12-22 15:10:06,474] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,474] {batch.py:309} INFO - 2020-12-22 15:09:42,494 INFO storage.BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
[2020-12-22 15:10:06,474] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,474] {batch.py:309} INFO - 2020-12-22 15:09:42,562 INFO storage.BlockManagerMaster: Registering BlockManager BlockManagerId(driver, livy, 7002, None)
[2020-12-22 15:10:06,475] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,475] {batch.py:309} INFO - 2020-12-22 15:09:42,566 INFO storage.BlockManagerMasterEndpoint: Registering block manager livy:7002 with 366.3 MB RAM, BlockManagerId(driver, livy, 7002, None)
[2020-12-22 15:10:06,475] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,475] {batch.py:309} INFO - 2020-12-22 15:09:42,578 INFO storage.BlockManagerMaster: Registered BlockManager BlockManagerId(driver, livy, 7002, None)
[2020-12-22 15:10:06,475] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,475] {batch.py:309} INFO - 2020-12-22 15:09:42,579 INFO storage.BlockManager: Initialized BlockManager: BlockManagerId(driver, livy, 7002, None)
[2020-12-22 15:10:06,475] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,475] {batch.py:309} INFO - 2020-12-22 15:09:42,891 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@71882ae1{/metrics/json,null,AVAILABLE,@Spark}
[2020-12-22 15:10:06,475] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,475] {batch.py:309} INFO - 2020-12-22 15:09:42,983 INFO cluster.YarnClientSchedulerBackend: Add WebUI Filter. org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter, Map(PROXY_HOSTS -> master, PROXY_URI_BASES -> http://master:8088/proxy/application_1608647635904_0011), /proxy/application_1608647635904_0011
[2020-12-22 15:10:06,475] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,475] {batch.py:309} INFO - 2020-12-22 15:09:43,069 INFO scheduler.EventLoggingListener: Logging events to hdfs:/log/spark/application_1608647635904_0011
[2020-12-22 15:10:06,476] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,475] {batch.py:309} INFO - 2020-12-22 15:09:43,353 INFO cluster.YarnSchedulerBackend$YarnSchedulerEndpoint: ApplicationMaster registered as NettyRpcEndpointRef(spark-client://YarnAM)
[2020-12-22 15:10:06,476] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,476] {batch.py:309} INFO - 2020-12-22 15:09:51,828 INFO cluster.YarnSchedulerBackend$YarnDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.18.0.8:46184) with ID 1
[2020-12-22 15:10:06,476] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,476] {batch.py:309} INFO - 2020-12-22 15:09:52,119 INFO storage.BlockManagerMasterEndpoint: Registering block manager worker1:7002 with 366.3 MB RAM, BlockManagerId(1, worker1, 7002, None)
[2020-12-22 15:10:06,476] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,476] {batch.py:309} INFO - 2020-12-22 15:09:52,388 INFO cluster.YarnSchedulerBackend$YarnDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.18.0.6:38178) with ID 2
[2020-12-22 15:10:06,476] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,476] {batch.py:309} INFO - 2020-12-22 15:09:52,395 INFO cluster.YarnClientSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.8
[2020-12-22 15:10:06,476] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,476] {batch.py:309} INFO - 2020-12-22 15:09:52,624 INFO internal.SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/spark-warehouse').
[2020-12-22 15:10:06,476] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,476] {batch.py:309} INFO - 2020-12-22 15:09:52,625 INFO internal.SharedState: Warehouse path is 'file:/spark-warehouse'.
[2020-12-22 15:10:06,477] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,476] {batch.py:309} INFO - 2020-12-22 15:09:52,635 INFO storage.BlockManagerMasterEndpoint: Registering block manager worker2:7002 with 366.3 MB RAM, BlockManagerId(2, worker2, 7002, None)
[2020-12-22 15:10:06,477] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,477] {batch.py:309} INFO - 2020-12-22 15:09:52,640 INFO ui.JettyUtils: Adding filter org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter to /SQL.
[2020-12-22 15:10:06,477] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,477] {batch.py:309} INFO - 2020-12-22 15:09:52,647 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@6f77a21d{/SQL,null,AVAILABLE,@Spark}
[2020-12-22 15:10:06,477] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,477] {batch.py:309} INFO - 2020-12-22 15:09:52,648 INFO ui.JettyUtils: Adding filter org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter to /SQL/json.
[2020-12-22 15:10:06,477] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,477] {batch.py:309} INFO - 2020-12-22 15:09:52,654 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@4a8221f3{/SQL/json,null,AVAILABLE,@Spark}
[2020-12-22 15:10:06,477] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,477] {batch.py:309} INFO - 2020-12-22 15:09:52,655 INFO ui.JettyUtils: Adding filter org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter to /SQL/execution.
[2020-12-22 15:10:06,477] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,477] {batch.py:309} INFO - 2020-12-22 15:09:52,656 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@56e776fb{/SQL/execution,null,AVAILABLE,@Spark}
[2020-12-22 15:10:06,478] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,478] {batch.py:309} INFO - 2020-12-22 15:09:52,656 INFO ui.JettyUtils: Adding filter org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter to /SQL/execution/json.
[2020-12-22 15:10:06,478] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,478] {batch.py:309} INFO - 2020-12-22 15:09:52,657 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@723e1c7e{/SQL/execution/json,null,AVAILABLE,@Spark}
[2020-12-22 15:10:06,478] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,478] {batch.py:309} INFO - 2020-12-22 15:09:52,658 INFO ui.JettyUtils: Adding filter org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter to /static/sql.
[2020-12-22 15:10:06,478] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,478] {batch.py:309} INFO - 2020-12-22 15:09:52,659 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@96f2757{/static/sql,null,AVAILABLE,@Spark}
[2020-12-22 15:10:06,478] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,478] {batch.py:309} INFO - 2020-12-22 15:09:53,428 INFO state.StateStoreCoordinatorRef: Registered StateStoreCoordinator endpoint
[2020-12-22 15:10:06,479] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,478] {batch.py:309} INFO - 2020-12-22 15:09:53,499 WARN <LoanDefaultPrediction application_1608647635904_0011>: loaded config from config.json
[2020-12-22 15:10:06,479] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,479] {batch.py:309} INFO - Traceback (most recent call last):
[2020-12-22 15:10:06,479] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,479] {batch.py:309} INFO -   File "/tmp/spark-dc1274f9-ed33-4342-9dc9-b579c4f5ada8/main.py", line 93, in <module>
[2020-12-22 15:10:06,479] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,479] {batch.py:309} INFO -     main()
[2020-12-22 15:10:06,479] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,479] {batch.py:309} INFO -   File "/tmp/spark-dc1274f9-ed33-4342-9dc9-b579c4f5ada8/main.py", line 79, in main
[2020-12-22 15:10:06,479] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,479] {batch.py:309} INFO -     job_module = importlib.import_module(f"jobs.{args.job}")
[2020-12-22 15:10:06,479] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,479] {batch.py:309} INFO -   File "/usr/lib/python3.7/importlib/__init__.py", line 127, in import_module
[2020-12-22 15:10:06,480] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,479] {batch.py:309} INFO -     return _bootstrap._gcd_import(name[level:], package, level)
[2020-12-22 15:10:06,480] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,480] {batch.py:309} INFO -   File "<frozen importlib._bootstrap>", line 1006, in _gcd_import
[2020-12-22 15:10:06,480] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,480] {batch.py:309} INFO -   File "<frozen importlib._bootstrap>", line 983, in _find_and_load
[2020-12-22 15:10:06,480] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,480] {batch.py:309} INFO -   File "<frozen importlib._bootstrap>", line 967, in _find_and_load_unlocked
[2020-12-22 15:10:06,480] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,480] {batch.py:309} INFO -   File "<frozen importlib._bootstrap>", line 668, in _load_unlocked
[2020-12-22 15:10:06,480] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,480] {batch.py:309} INFO -   File "<frozen importlib._bootstrap>", line 638, in _load_backward_compatible
[2020-12-22 15:10:06,480] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,480] {batch.py:309} INFO -   File "/tmp/spark-224f6a6b-33c4-4a7e-93b5-7b31e071671c/userFiles-85078ecf-e41a-4d88-867f-67d24439fc01/src.zip/jobs/preprocess_data.py", line 4, in <module>
[2020-12-22 15:10:06,481] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,480] {batch.py:309} INFO -   File "/usr/spark/python/lib/pyspark.zip/pyspark/ml/__init__.py", line 22, in <module>
[2020-12-22 15:10:06,481] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,481] {batch.py:309} INFO -   File "/usr/spark/python/lib/pyspark.zip/pyspark/ml/base.py", line 24, in <module>
[2020-12-22 15:10:06,481] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,481] {batch.py:309} INFO -   File "/usr/spark/python/lib/pyspark.zip/pyspark/ml/param/__init__.py", line 26, in <module>
[2020-12-22 15:10:06,481] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,481] {batch.py:309} INFO - ModuleNotFoundError: No module named 'numpy'
[2020-12-22 15:10:06,481] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,481] {batch.py:309} INFO - 2020-12-22 15:09:53,563 INFO spark.SparkContext: Invoking stop() from shutdown hook
[2020-12-22 15:10:06,481] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,481] {batch.py:309} INFO - 2020-12-22 15:09:53,572 INFO server.AbstractConnector: Stopped Spark@59b710e7{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
[2020-12-22 15:10:06,482] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,481] {batch.py:309} INFO - 2020-12-22 15:09:53,575 INFO ui.SparkUI: Stopped Spark web UI at http://livy:4040
[2020-12-22 15:10:06,482] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,482] {batch.py:309} INFO - 2020-12-22 15:09:53,580 INFO cluster.YarnClientSchedulerBackend: Interrupting monitor thread
[2020-12-22 15:10:06,482] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,482] {batch.py:309} INFO - 2020-12-22 15:09:53,620 INFO cluster.YarnClientSchedulerBackend: Shutting down all executors
[2020-12-22 15:10:06,482] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,482] {batch.py:309} INFO - 2020-12-22 15:09:53,622 INFO cluster.YarnSchedulerBackend$YarnDriverEndpoint: Asking each executor to shut down
[2020-12-22 15:10:06,482] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,482] {batch.py:309} INFO - 2020-12-22 15:09:53,629 INFO cluster.SchedulerExtensionServices: Stopping SchedulerExtensionServices
[2020-12-22 15:10:06,482] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,482] {batch.py:309} INFO - (serviceOption=None,
[2020-12-22 15:10:06,482] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,482] {batch.py:309} INFO -  services=List(),
[2020-12-22 15:10:06,483] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,482] {batch.py:309} INFO -  started=false)
[2020-12-22 15:10:06,483] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,483] {batch.py:309} INFO - 2020-12-22 15:09:53,634 INFO cluster.YarnClientSchedulerBackend: Stopped
[2020-12-22 15:10:06,483] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,483] {batch.py:309} INFO - 2020-12-22 15:09:53,696 INFO spark.MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
[2020-12-22 15:10:06,483] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,483] {batch.py:309} INFO - 2020-12-22 15:09:53,714 INFO memory.MemoryStore: MemoryStore cleared
[2020-12-22 15:10:06,483] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,483] {batch.py:309} INFO - 2020-12-22 15:09:53,717 INFO storage.BlockManager: BlockManager stopped
[2020-12-22 15:10:06,483] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,483] {batch.py:309} INFO - 2020-12-22 15:09:53,727 INFO storage.BlockManagerMaster: BlockManagerMaster stopped
[2020-12-22 15:10:06,483] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,483] {batch.py:309} INFO - 2020-12-22 15:09:53,738 INFO scheduler.OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
[2020-12-22 15:10:06,484] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,483] {batch.py:309} INFO - 2020-12-22 15:09:53,778 INFO spark.SparkContext: Successfully stopped SparkContext
[2020-12-22 15:10:06,484] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,484] {batch.py:309} INFO - 2020-12-22 15:09:53,778 INFO util.ShutdownHookManager: Shutdown hook called
[2020-12-22 15:10:06,484] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,484] {batch.py:309} INFO - 2020-12-22 15:09:53,780 INFO util.ShutdownHookManager: Deleting directory /tmp/spark-224f6a6b-33c4-4a7e-93b5-7b31e071671c/pyspark-4291b554-b65f-44d9-b602-62b34e0868cc
[2020-12-22 15:10:06,484] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,484] {batch.py:309} INFO - 2020-12-22 15:09:53,790 INFO util.ShutdownHookManager: Deleting directory /tmp/spark-224f6a6b-33c4-4a7e-93b5-7b31e071671c
[2020-12-22 15:10:06,484] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,484] {batch.py:309} INFO - 2020-12-22 15:09:53,795 INFO util.ShutdownHookManager: Deleting directory /tmp/spark-dc1274f9-ed33-4342-9dc9-b579c4f5ada8
[2020-12-22 15:10:06,484] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,484] {batch.py:309} INFO - 2020-12-22 15:09:53,806 INFO impl.MetricsSystemImpl: Stopping s3a-file-system metrics system...
[2020-12-22 15:10:06,484] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,484] {batch.py:309} INFO - 2020-12-22 15:09:53,806 INFO impl.MetricsSystemImpl: s3a-file-system metrics system stopped.
[2020-12-22 15:10:06,494] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,494] {base_hook.py:84} INFO - Using connection to: id: livy. Host: ec2-3-236-26-7.compute-1.amazonaws.com, Port: 8998, Schema: None, Login: None, Password: None, extra: None
[2020-12-22 15:10:06,495] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,495] {http_hook.py:136} INFO - Sending 'GET' to url: http://ec2-3-236-26-7.compute-1.amazonaws.com:8998/batches/10/log?from=200&size=100
[2020-12-22 15:10:06,501] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,501] {batch.py:309} INFO - 2020-12-22 15:09:53,806 INFO impl.MetricsSystemImpl: s3a-file-system metrics system shutdown complete.
[2020-12-22 15:10:06,501] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,501] {batch.py:309} INFO - 
stderr: 
[2020-12-22 15:10:06,501] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,501] {batch.py:309} INFO - 
YARN Diagnostics: 
[2020-12-22 15:10:06,502] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,501] {batch.py:318} INFO - --------------------------------------------------End of full log for batch 10--------------------------------------------------
[2020-12-22 15:10:06,502] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,502] {batch.py:335} INFO - Closing batch with id = 10
[2020-12-22 15:10:06,509] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,509] {base_hook.py:84} INFO - Using connection to: id: livy. Host: ec2-3-236-26-7.compute-1.amazonaws.com, Port: 8998, Schema: None, Login: None, Password: None, extra: None
[2020-12-22 15:10:06,510] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,510] {http_hook.py:136} INFO - Sending 'DELETE' to url: http://ec2-3-236-26-7.compute-1.amazonaws.com:8998/batches/10
[2020-12-22 15:10:06,525] {logging_mixin.py:112} INFO - [2020-12-22 15:10:06,525] {batch.py:340} INFO - Batch 10 has been closed
[2020-12-22 15:10:06,533] {taskinstance.py:1128} ERROR - Batch 10 failed with state 'dead'
Traceback (most recent call last):
  File "/opt/bitnami/python/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 966, in _run_raw_task
    result = task_copy.execute(context=context)
  File "/usr/local/airflow/plugins/airflow_livy/batch.py", line 173, in execute
    ).execute(context)
  File "/opt/bitnami/python/lib/python3.6/site-packages/airflow/sensors/base_sensor_operator.py", line 107, in execute
    while not self.poke(context):
  File "/usr/local/airflow/plugins/airflow_livy/batch.py", line 96, in poke
    raise AirflowException(f"Batch {self.batch_id} failed with state '{state}'")
airflow.exceptions.AirflowException: Batch 10 failed with state 'dead'
[2020-12-22 15:10:06,535] {taskinstance.py:1170} INFO - All retries failed; marking task as FAILED.dag_id=loan_prediction_train_model, task_id=preprocess_data, execution_date=20201222T150043, start_date=20201222T150926, end_date=20201222T151006
[2020-12-22 15:10:11,290] {logging_mixin.py:112} INFO - [2020-12-22 15:10:11,290] {local_task_job.py:103} INFO - Task exited with return code 1
